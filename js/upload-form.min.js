let photo_overlay = document.querySelector(".upload-overlay"), inputElement = document.querySelector("#upload-file"), photo_close = document.querySelector(".upload-form-cancel"), upload_form_submit = document.querySelector(".upload-form-submit"); function handleFiles(e) { file = e.target.files[0]; let t = new FileReader; function l() { photo_overlay.classList.remove("hidden") } t.addEventListener("load", function () { filter_image.src = t.result, l() }, l, !1), file && t.readAsDataURL(file), document.addEventListener("keydown", function (e) { 27 === e.keyCode && photo_overlay.classList.add("hidden") }) } filter_image = document.querySelector("#filter-image"), inputElement.addEventListener("change", handleFiles, !1), photo_close.addEventListener("click", function () { photo_overlay.classList.add("hidden"), inputElement.click() }); let result, increase_size = document.querySelector(".upload-resize-controls-button-inc"), decrease_size = document.querySelector(".upload-resize-controls-button-dec"), increase_input = document.querySelector(".upload-resize-controls-value"), effect = document.querySelector(".upload-effect-controls"), photo_preview = document.querySelector(".effect-image-preview"), lineWidth = 455, pin = document.querySelector(".upload-effect-level-pin"); increase_size.addEventListener("click", function () { let e = parseInt(increase_input.value); 50 == (e += 25) ? photo_preview.style.transform = "scale(0.5)" : 75 == e ? photo_preview.style.transform = "scale(0.75)" : 100 == e && (photo_preview.style.transform = "scale(1)"), e > 100 && (e = 100), increase_input.value = e }), decrease_size.addEventListener("click", function () { let e = parseInt(increase_input.value); 75 == (e -= 25) ? photo_preview.style.transform = "scale(0.75)" : 50 == e ? photo_preview.style.transform = "scale(0.5)" : 25 == e && (photo_preview.style.transform = "scale(0.25)"), e < 25 && (e = 25), increase_input.value = e }); let effect_line = document.querySelector(".upload-effect-level"); function dragElement(e) { let t = 0, l = 0; function o(o) { (o = o || window.event).preventDefault(), t = l - o.clientX, l = o.clientX, level_bar.style.width = pin.style.left, filter_image.classList.contains("effect-chrome") ? (result = +pin.style.left.slice(0, -2) / lineWidth, photo_preview.style.filter = "grayscale(" + result + ")") : filter_image.classList.contains("effect-sepia") ? (result = +pin.style.left.slice(0, -2) / lineWidth, photo_preview.style.filter = "sepia(" + result + ")") : filter_image.classList.contains("effect-marvin") ? (result = +pin.style.left.slice(0, -2) / lineWidth, photo_preview.style.filter = "invert(" + result + ")") : filter_image.classList.contains("effect-phobos") ? (result = +pin.style.left.slice(0, -2) / 90, photo_preview.style.filter = "blur(" + result + "px)") : filter_image.classList.contains("effect-heat") && (result = +pin.style.left.slice(0, -2) / 150, photo_preview.style.filter = "brightness(" + result + ")"), (e.style.left = e.offsetLeft - t < 0) && (e.style.left = "0px"), (e.style.left = e.offsetLeft - t > 450) ? e.style.left = "445px" : e.style.left = e.offsetLeft - t + "px" } function s() { document.onmouseup = null, document.onmousemove = null } document.querySelector(".upload-effect-level-pin").onmousedown = function (e) { (e = e || window.event).preventDefault(), l = e.clientX, document.onmouseup = s, document.onmousemove = o } } effect.addEventListener("click", function (e) { let t = e.target; t.classList.contains("upload-effect-none") ? (photo_preview.className = "none", photo_preview.style = "", effect_line.style.display = "none") : t.classList.contains("upload-effect-chrome") ? (photo_preview.className = "", photo_preview.style = "", effect_line.style.display = "block", photo_preview.classList.add("effect-chrome")) : t.classList.contains("upload-effect-sepia") ? (photo_preview.className = "", photo_preview.style = "", effect_line.style.display = "block", photo_preview.classList.add("effect-sepia")) : t.classList.contains("upload-effect-marvin") ? (photo_preview.className = "", photo_preview.style = "", effect_line.style.display = "block", photo_preview.classList.add("effect-marvin")) : t.classList.contains("upload-effect-phobos") ? (photo_preview.className = "", photo_preview.style = "", effect_line.style.display = "block", photo_preview.classList.add("effect-phobos")) : t.classList.contains("upload-effect-heat") && (photo_preview.className = "", photo_preview.style = "", effect_line.style.display = "block", photo_preview.classList.add("effect-heat")) }, !1), level_bar = document.querySelector(".upload-effect-level-val"), dragElement(pin); let form = document.querySelector(".upload-form"); form.addEventListener("submit", function (e) { e.preventDefault(); let t = new XMLHttpRequest; t.open("POST", "http://localhost"), t.send(new FormData(form)) });